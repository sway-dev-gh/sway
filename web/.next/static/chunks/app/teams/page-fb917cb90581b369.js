(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[619],{4033:function(e,t,a){Promise.resolve().then(a.bind(a,9686))},9686:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return v}});var i=a(7437),n=a(2265),r=a(429),s=a(5095),l=a(8346);class o{async makeRequest(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=localStorage.getItem("token"),i={headers:{"Content-Type":"application/json",...a&&{Authorization:"Bearer ".concat(a)}}},n=await fetch("".concat("https://api.swayfiles.com").concat(e),{...i,...t,headers:{...i.headers,...t.headers}});if(!n.ok)throw Error(await n.text()||"HTTP error! status: ".concat(n.status));return n.json()}async getTeamOverview(){try{return await this.makeRequest("/team")}catch(e){throw console.error("Error fetching team overview:",e),e}}async inviteTeamMember(e){let{email:t,role:a,projectId:i,message:n,permissions:r}=e;try{return await this.makeRequest("/team/invite",{method:"POST",body:JSON.stringify({email:t,role:a||"viewer",project_id:i,message:n,permissions:r})})}catch(e){throw console.error("Error inviting team member:",e),e}}async getPendingInvitations(){try{return await this.makeRequest("/team/invitations")}catch(e){throw console.error("Error fetching pending invitations:",e),e}}async acceptInvitation(e){try{return await this.makeRequest("/team/accept-invitation",{method:"POST",body:JSON.stringify({invitation_token:e})})}catch(e){throw console.error("Error accepting invitation:",e),e}}async removeTeamMember(e){try{return await this.makeRequest("/team/".concat(e),{method:"DELETE"})}catch(e){throw console.error("Error removing team member:",e),e}}getRoleDisplayName(e){return({viewer:"Viewer",editor:"Editor",reviewer:"Reviewer"})[e]||e}getRoleDescription(e){return({viewer:"Can view projects and files",editor:"Can view and edit content",reviewer:"Can view and review content"})[e]||"Unknown role"}getRoleColor(e){return({viewer:"text-blue-400 bg-blue-900/20",editor:"text-green-400 bg-green-900/20",reviewer:"text-yellow-400 bg-yellow-900/20"})[e]||"text-gray-400 bg-gray-900/20"}getPermissionDisplayName(e){return({can_view:"View Projects",can_edit:"Edit Content",can_review:"Review Changes",can_invite:"Invite Members"})[e]||e}getDefaultPermissions(e){let t={viewer:{can_view:!0,can_edit:!1,can_review:!1,can_invite:!1},editor:{can_view:!0,can_edit:!0,can_review:!1,can_invite:!1},reviewer:{can_view:!0,can_edit:!1,can_review:!0,can_invite:!1}};return t[e]||t.viewer}formatExpirationTime(e){let t=new Date,a=new Date(e)-t,i=Math.floor(a/864e5),n=Math.floor(a%864e5/36e5);return i>0?"".concat(i," day").concat(i>1?"s":""," remaining"):n>0?"".concat(n," hour").concat(n>1?"s":""," remaining"):a>0?"Less than 1 hour remaining":"Expired"}formatDate(e){return e?new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"Unknown"}formatRelativeTime(e){if(!e)return"Unknown";let t=new Date-new Date(e),a=Math.floor(t/6e4),i=Math.floor(t/36e5),n=Math.floor(t/864e5);return a<1?"Just now":a<60?"".concat(a," minute").concat(1===a?"":"s"," ago"):i<24?"".concat(i," hour").concat(1===i?"":"s"," ago"):n<7?"".concat(n," day").concat(1===n?"":"s"," ago"):this.formatDate(e)}}var c=new o,m=a(3289);let d=e=>{let{member:t,onRemove:a}=e,[l,o]=(0,n.useState)(!1),m=async()=>{try{await a(t.id),o(!1)}catch(e){console.error("Failed to remove member:",e)}};return(0,i.jsxs)(r.E.div,{layout:!0,initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"bg-terminal-surface border border-terminal-border rounded-lg p-4",children:[(0,i.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,i.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,i.jsx)("div",{className:"w-10 h-10 bg-terminal-accent rounded-full flex items-center justify-center",children:(0,i.jsx)("span",{className:"text-terminal-text font-medium",children:(t.name||t.email).charAt(0).toUpperCase()})}),(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{className:"text-terminal-text font-medium",children:t.name||"Unknown"}),(0,i.jsx)("div",{className:"text-terminal-muted text-sm",children:t.email})]})]}),(0,i.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,i.jsx)("span",{className:"text-xs px-2 py-1 rounded ".concat(c.getRoleColor(t.role)),children:c.getRoleDisplayName(t.role)}),(0,i.jsx)("button",{onClick:()=>o(!0),className:"text-terminal-muted hover:text-red-400 text-sm",children:"Remove"})]})]}),(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-xs",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("span",{className:"text-terminal-muted",children:"Active Projects:"}),(0,i.jsx)("span",{className:"text-terminal-text ml-1",children:t.active_projects||0})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("span",{className:"text-terminal-muted",children:"Last Active:"}),(0,i.jsx)("span",{className:"text-terminal-text ml-1",children:c.formatRelativeTime(t.last_activity_at)})]})]}),t.permissions&&(0,i.jsxs)("div",{className:"mt-3",children:[(0,i.jsx)("div",{className:"text-xs text-terminal-muted mb-2",children:"Permissions:"}),(0,i.jsx)("div",{className:"flex flex-wrap gap-1",children:Object.entries(JSON.parse(t.permissions)).map(e=>{let[t,a]=e;return a&&(0,i.jsx)("span",{className:"text-xs bg-terminal-accent text-terminal-text px-2 py-1 rounded",children:c.getPermissionDisplayName(t)},t)})})]}),(0,i.jsx)(s.M,{children:l&&(0,i.jsx)(r.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",onClick:()=>o(!1),children:(0,i.jsxs)(r.E.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},className:"bg-terminal-surface border border-terminal-border rounded-lg p-6 max-w-md w-full mx-4",onClick:e=>e.stopPropagation(),children:[(0,i.jsx)("h3",{className:"text-terminal-text font-medium mb-2",children:"Remove Team Member"}),(0,i.jsxs)("p",{className:"text-terminal-muted text-sm mb-4",children:["Are you sure you want to remove ",t.name||t.email," from your team? This action cannot be undone."]}),(0,i.jsxs)("div",{className:"flex space-x-3",children:[(0,i.jsx)("button",{onClick:m,className:"bg-red-600 text-white px-4 py-2 text-sm rounded hover:bg-red-700",children:"Remove"}),(0,i.jsx)("button",{onClick:()=>o(!1),className:"border border-terminal-border text-terminal-text px-4 py-2 text-sm rounded hover:bg-terminal-accent",children:"Cancel"})]})]})})})]})},x=e=>{let{onInvite:t,onCancel:a,projects:s}=e,[l,o]=(0,n.useState)(""),[c,m]=(0,n.useState)("viewer"),[d,x]=(0,n.useState)(""),[u,v]=(0,n.useState)(""),[h,b]=(0,n.useState)(!1),p=async e=>{e.preventDefault(),b(!0);try{await t({email:l,role:c,projectId:d||null,message:u}),o(""),m("viewer"),x(""),v(""),a()}catch(e){console.error("Failed to invite member:",e)}finally{b(!1)}};return(0,i.jsx)(r.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",onClick:a,children:(0,i.jsxs)(r.E.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},className:"bg-terminal-surface border border-terminal-border rounded-lg p-6 max-w-md w-full mx-4",onClick:e=>e.stopPropagation(),children:[(0,i.jsx)("h3",{className:"text-terminal-text font-medium mb-4",children:"Invite Team Member"}),(0,i.jsxs)("form",{onSubmit:p,className:"space-y-4",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-terminal-text text-sm mb-2",children:"Email Address"}),(0,i.jsx)("input",{type:"email",value:l,onChange:e=>o(e.target.value),className:"w-full bg-terminal-bg border border-terminal-border rounded px-3 py-2 text-terminal-text focus:outline-none focus:border-terminal-text",placeholder:"colleague@example.com",required:!0})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-terminal-text text-sm mb-2",children:"Role"}),(0,i.jsxs)("select",{value:c,onChange:e=>m(e.target.value),className:"w-full bg-terminal-bg border border-terminal-border rounded px-3 py-2 text-terminal-text focus:outline-none focus:border-terminal-text",children:[(0,i.jsx)("option",{value:"viewer",children:"Viewer - Can view projects"}),(0,i.jsx)("option",{value:"editor",children:"Editor - Can view and edit"}),(0,i.jsx)("option",{value:"reviewer",children:"Reviewer - Can view and review"})]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-terminal-text text-sm mb-2",children:"Project (Optional)"}),(0,i.jsxs)("select",{value:d,onChange:e=>x(e.target.value),className:"w-full bg-terminal-bg border border-terminal-border rounded px-3 py-2 text-terminal-text focus:outline-none focus:border-terminal-text",children:[(0,i.jsx)("option",{value:"",children:"All projects"}),null==s?void 0:s.map(e=>(0,i.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-terminal-text text-sm mb-2",children:"Message (Optional)"}),(0,i.jsx)("textarea",{value:u,onChange:e=>v(e.target.value),className:"w-full bg-terminal-bg border border-terminal-border rounded px-3 py-2 text-terminal-text focus:outline-none focus:border-terminal-text resize-none",rows:3,placeholder:"Personal message to include with the invitation..."})]}),(0,i.jsxs)("div",{className:"flex space-x-3",children:[(0,i.jsx)("button",{type:"submit",disabled:h||!l,className:"bg-terminal-text text-terminal-bg px-4 py-2 text-sm rounded hover:bg-terminal-text/90 disabled:opacity-50",children:h?"Sending...":"Send Invitation"}),(0,i.jsx)("button",{type:"button",onClick:a,className:"border border-terminal-border text-terminal-text px-4 py-2 text-sm rounded hover:bg-terminal-accent",children:"Cancel"})]})]})]})})},u=e=>{let{invitation:t}=e;return(0,i.jsxs)("div",{className:"bg-terminal-surface border border-yellow-500/50 rounded-lg p-4",children:[(0,i.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{className:"text-terminal-text font-medium",children:t.email}),(0,i.jsxs)("div",{className:"text-terminal-muted text-sm",children:["Invited ",c.formatRelativeTime(t.created_at)]})]}),(0,i.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,i.jsx)("span",{className:"text-xs px-2 py-1 rounded ".concat(c.getRoleColor(t.role)),children:c.getRoleDisplayName(t.role)}),(0,i.jsx)("span",{className:"text-xs text-yellow-400 bg-yellow-900/20 px-2 py-1 rounded",children:"Pending"})]})]}),(0,i.jsxs)("div",{className:"text-xs text-terminal-muted",children:["Expires: ",c.formatExpirationTime(t.expires_at)]})]})};function v(){var e,t,a,r,o,v,h,b,p;let[j,g]=(0,n.useState)(null),[f,y]=(0,n.useState)(!0),[N,w]=(0,n.useState)(null),[_,k]=(0,n.useState)(!1),[C,R]=(0,n.useState)("members"),{showNotification:E}=(0,m.Z)(),T=async()=>{try{y(!0),w(null);let e=await c.getTeamOverview();g(e)}catch(e){w(e instanceof Error?e.message:"Failed to load team data")}finally{y(!1)}};(0,n.useEffect)(()=>{T()},[]);let S=async e=>{try{await c.inviteTeamMember({...e,permissions:{}}),await T(),E("team_invitation_sent","Team Invitation Sent","Invitation sent to ".concat(e.email," as ").concat(c.getRoleDisplayName(e.role)))}catch(t){throw E("error","Invitation Failed","Failed to send invitation to ".concat(e.email)),t}},P=async e=>{try{await c.removeTeamMember(e),await T(),E("team_member_removed","Member Removed","Team member has been removed successfully")}catch(e){throw E("error","Remove Failed","Failed to remove team member"),e}};return f?(0,i.jsx)(l.Z,{children:(0,i.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,i.jsx)("div",{className:"text-terminal-muted",children:"Loading teams..."})})}):N?(0,i.jsx)(l.Z,{children:(0,i.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,i.jsxs)("div",{className:"text-center",children:[(0,i.jsxs)("div",{className:"text-red-400 mb-4",children:["Error: ",N]}),(0,i.jsx)("button",{onClick:T,className:"text-terminal-text border border-terminal-border px-4 py-2 rounded hover:bg-terminal-accent",children:"Retry"})]})})}):(0,i.jsx)(l.Z,{children:(0,i.jsxs)("div",{className:"flex-1 overflow-auto bg-terminal-bg",children:[(0,i.jsxs)("div",{className:"bg-terminal-surface border-b border-terminal-border p-6",children:[(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("h1",{className:"text-xl text-terminal-text font-medium",children:"Teams"}),(0,i.jsx)("p",{className:"text-terminal-muted text-sm mt-1",children:"Manage team members and collaborate on projects"})]}),(0,i.jsx)("button",{onClick:()=>k(!0),className:"bg-terminal-text text-terminal-bg px-4 py-2 text-sm rounded hover:bg-terminal-text/90",children:"Invite Members"})]}),(0,i.jsxs)("div",{className:"grid grid-cols-3 gap-6 mt-6",children:[(0,i.jsxs)("div",{className:"text-center",children:[(0,i.jsx)("div",{className:"text-2xl font-medium text-terminal-text",children:(null==j?void 0:null===(e=j.stats)||void 0===e?void 0:e.total_team_members)||0}),(0,i.jsx)("div",{className:"text-sm text-terminal-muted",children:"Team Members"})]}),(0,i.jsxs)("div",{className:"text-center",children:[(0,i.jsx)("div",{className:"text-2xl font-medium text-terminal-text",children:(null==j?void 0:null===(t=j.stats)||void 0===t?void 0:t.pending_invitations)||0}),(0,i.jsx)("div",{className:"text-sm text-terminal-muted",children:"Pending Invitations"})]}),(0,i.jsxs)("div",{className:"text-center",children:[(0,i.jsx)("div",{className:"text-2xl font-medium text-terminal-text",children:(null==j?void 0:null===(a=j.stats)||void 0===a?void 0:a.teams_member_of)||0}),(0,i.jsx)("div",{className:"text-sm text-terminal-muted",children:"Teams Joined"})]})]})]}),(0,i.jsx)("div",{className:"border-b border-terminal-border",children:(0,i.jsx)("div",{className:"flex px-6",children:[{id:"members",label:"My Team",count:null==j?void 0:null===(r=j.team)||void 0===r?void 0:r.length},{id:"invitations",label:"Pending Invitations",count:null==j?void 0:null===(o=j.pending_invitations)||void 0===o?void 0:o.length},{id:"teams",label:"Teams I'm In",count:null==j?void 0:null===(v=j.member_of_teams)||void 0===v?void 0:v.length}].map(e=>(0,i.jsxs)("button",{onClick:()=>R(e.id),className:"\n                  px-4 py-3 text-sm border-b-2 transition-colors\n                  ".concat(C===e.id?"border-terminal-text text-terminal-text":"border-transparent text-terminal-muted hover:text-terminal-text","\n                "),children:[e.label,e.count>0&&(0,i.jsx)("span",{className:"ml-1 bg-terminal-accent text-terminal-text text-xs px-2 py-1 rounded",children:e.count})]},e.id))})}),(0,i.jsxs)("div",{className:"p-6",children:["members"===C&&(0,i.jsxs)("div",{children:[(0,i.jsx)("h2",{className:"text-lg font-medium text-terminal-text mb-4",children:"Team Members"}),(null==j?void 0:null===(h=j.team)||void 0===h?void 0:h.length)>0?(0,i.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:(0,i.jsx)(s.M,{children:j.team.map(e=>(0,i.jsx)(d,{member:e,onRemove:P},e.id))})}):(0,i.jsxs)("div",{className:"text-center py-12 bg-terminal-surface border border-terminal-border rounded-lg",children:[(0,i.jsx)("div",{className:"text-terminal-muted mb-4",children:"No team members yet"}),(0,i.jsx)("button",{onClick:()=>k(!0),className:"bg-terminal-text text-terminal-bg px-4 py-2 text-sm rounded hover:bg-terminal-text/90",children:"Invite Your First Member"})]})]}),"invitations"===C&&(0,i.jsxs)("div",{children:[(0,i.jsx)("h2",{className:"text-lg font-medium text-terminal-text mb-4",children:"Pending Invitations"}),(null==j?void 0:null===(b=j.pending_invitations)||void 0===b?void 0:b.length)>0?(0,i.jsx)("div",{className:"space-y-3",children:j.pending_invitations.map(e=>(0,i.jsx)(u,{invitation:e},e.id))}):(0,i.jsx)("div",{className:"text-center py-12 bg-terminal-surface border border-terminal-border rounded-lg",children:(0,i.jsx)("div",{className:"text-terminal-muted",children:"No pending invitations"})})]}),"teams"===C&&(0,i.jsxs)("div",{children:[(0,i.jsx)("h2",{className:"text-lg font-medium text-terminal-text mb-4",children:"Teams I'm Part Of"}),(null==j?void 0:null===(p=j.member_of_teams)||void 0===p?void 0:p.length)>0?(0,i.jsx)("div",{className:"space-y-3",children:j.member_of_teams.map(e=>(0,i.jsx)("div",{className:"bg-terminal-surface border border-terminal-border rounded-lg p-4",children:(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{className:"text-terminal-text font-medium",children:e.team_owner_name||e.team_owner_email}),(0,i.jsxs)("div",{className:"text-terminal-muted text-sm",children:[e.team_projects," project",1!==e.team_projects?"s":""]})]}),(0,i.jsx)("span",{className:"text-xs px-2 py-1 rounded ".concat(c.getRoleColor(e.my_role)),children:c.getRoleDisplayName(e.my_role)})]})},e.team_owner_id))}):(0,i.jsx)("div",{className:"text-center py-12 bg-terminal-surface border border-terminal-border rounded-lg",children:(0,i.jsx)("div",{className:"text-terminal-muted",children:"You haven't joined any teams yet"})})]})]}),(0,i.jsx)(s.M,{children:_&&(0,i.jsx)(x,{onInvite:S,onCancel:()=>k(!1),projects:(null==j?void 0:j.projects)||[]})})]})})}},3289:function(e,t,a){"use strict";var i=a(2265),n=a(8378);t.Z=()=>{let[e,t]=(0,i.useState)([]),[a,r]=(0,i.useState)(0),[s,l]=(0,i.useState)(!1),[o,c]=(0,i.useState)(null);(0,i.useEffect)(()=>{let e=n.Z.subscribe(e=>{t(e.notifications),r(e.unreadCount)});return m(),e},[]);let m=async()=>{l(!0),c(null);try{await n.Z.getNotifications()}catch(e){c(e.message||"Failed to load notifications")}finally{l(!1)}};return{notifications:e,unreadCount:a,loading:s,error:o,loadNotifications:m,markAsRead:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];n.Z.markAsRead(e)},clearAll:()=>{n.Z.clearAll()},showNotification:function(e,t,a){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};n.Z.createLocalNotification(e,t,a,i)},startPolling:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3e4;n.Z.startPolling(e)},stopPolling:()=>{n.Z.stopPolling()}}}}},function(e){e.O(0,[141,452,346,971,117,744],function(){return e(e.s=4033)}),_N_E=e.O()}]);