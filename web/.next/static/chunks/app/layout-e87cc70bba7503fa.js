(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{412:function(e,t,n){Promise.resolve().then(n.t.bind(n,7960,23)),Promise.resolve().then(n.bind(n,7766)),Promise.resolve().then(n.bind(n,6281)),Promise.resolve().then(n.t.bind(n,4742,23))},7766:function(e,t,n){"use strict";n.d(t,{AuthWrapper:function(){return u}});var r=n(7437),o=n(6281),s=n(9376),a=n(2265);let i=["/login","/signup"];function u(e){let{children:t}=e,{isAuthenticated:n,isLoading:u}=(0,o.a)(),c=(0,s.usePathname)(),l=i.includes(c);return((0,a.useEffect)(()=>{u||n||l||(window.location.href="/login")},[u,n,l]),u)?(0,r.jsx)("div",{className:"min-h-screen bg-terminal-bg flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"inline-block w-8 h-8 border-2 border-terminal-border border-t-terminal-text rounded-full animate-spin mb-4"}),(0,r.jsx)("p",{className:"text-terminal-text text-sm font-mono",children:"Authenticating..."})]})}):n||l?n&&l?(window.location.href="/",null):(0,r.jsx)(r.Fragment,{children:t}):null}},6281:function(e,t,n){"use strict";n.d(t,{AuthProvider:function(){return i},a:function(){return u}});var r=n(7437),o=n(2265),s=n(6023);let a=(0,o.createContext)(void 0);function i(e){let{children:t}=e,[n,i]=(0,o.useState)(null),[u,c]=(0,o.useState)(!0);(0,o.useEffect)(()=>{let e=s.i.getToken(),t=s.i.getUser();e&&t&&i(t),c(!1)},[]);let l=async(e,t)=>{let n=await s.i.login(e,t);return!!n.success&&!!n.user&&(i(n.user),!0)},f=async(e,t,n)=>{let r=await s.i.signup(e,t,n);return!!r.success&&!!r.user&&(i(r.user),!0)};return(0,r.jsx)(a.Provider,{value:{user:n,isAuthenticated:!!n,isLoading:u,login:l,signup:f,logout:()=>{s.i.logout(),i(null)}},children:t})}function u(){let e=(0,o.useContext)(a);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},6023:function(e,t,n){"use strict";n.d(t,{i:function(){return s}});let r="https://api.swayfiles.com",o=async()=>{try{let e=await fetch("".concat(r,"/api/csrf-token"),{method:"GET",credentials:"include",headers:{"Content-Type":"application/json"}}),t=await e.json();if(e.ok&&t.success&&t.csrfToken)return t.csrfToken;return console.error("Failed to get CSRF token:",t.message),null}catch(e){return console.error("Network error getting CSRF token:",e),null}},s={async login(e,t){try{let n=await o(),s={"Content-Type":"application/json"};n&&(s["X-CSRF-Token"]=n);let a=await fetch("".concat(r,"/api/auth/login"),{method:"POST",credentials:"include",headers:s,body:JSON.stringify({email:e,password:t})}),i=await a.json();if(a.ok&&i.token)return localStorage.setItem("token",i.token),localStorage.setItem("user",JSON.stringify(i.user)),{success:!0,user:i.user,token:i.token};return{success:!1,message:i.error||i.message||"Login failed"}}catch(e){return console.error("Login error:",e),{success:!1,message:"Network error occurred"}}},async signup(e,t,n){try{let s=await o(),a={"Content-Type":"application/json"};s&&(a["X-CSRF-Token"]=s);let i=await fetch("".concat(r,"/api/auth/signup"),{method:"POST",credentials:"include",headers:a,body:JSON.stringify({email:e,password:t,name:n})}),u=await i.json();if(i.ok&&u.token)return localStorage.setItem("token",u.token),localStorage.setItem("user",JSON.stringify(u.user)),{success:!0,user:u.user,token:u.token};return{success:!1,message:u.error||u.message||"Signup failed"}}catch(e){return console.error("Signup error:",e),{success:!1,message:"Network error occurred"}}},logout(){localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="/login"},getToken:()=>localStorage.getItem("token"),getUser(){let e=localStorage.getItem("user");return e?JSON.parse(e):null},isAuthenticated(){return!!this.getToken()}}},9376:function(e,t,n){"use strict";var r=n(5475);n.o(r,"usePathname")&&n.d(t,{usePathname:function(){return r.usePathname}}),n.o(r,"useRouter")&&n.d(t,{useRouter:function(){return r.useRouter}}),n.o(r,"useSearchParams")&&n.d(t,{useSearchParams:function(){return r.useSearchParams}})},7960:function(){},4742:function(e){e.exports={style:{fontFamily:"'__Inter_f367f3', '__Inter_Fallback_f367f3'",fontStyle:"normal"},className:"__className_f367f3"}}},function(e){e.O(0,[540,971,117,744],function(){return e(e.s=412)}),_N_E=e.O()}]);