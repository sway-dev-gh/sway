(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{412:function(e,t,r){Promise.resolve().then(r.t.bind(r,7960,23)),Promise.resolve().then(r.bind(r,7766)),Promise.resolve().then(r.bind(r,6281)),Promise.resolve().then(r.t.bind(r,4742,23))},7766:function(e,t,r){"use strict";r.d(t,{AuthWrapper:function(){return u}});var n=r(7437),s=r(6281),o=r(9376),i=r(2265);let a=["/login","/signup"];function u(e){let{children:t}=e,{isAuthenticated:r,isLoading:u}=(0,s.a)(),c=(0,o.usePathname)(),l=a.includes(c);return((0,i.useEffect)(()=>{u||r||l||(window.location.href="/login")},[u,r,l]),u)?(0,n.jsx)("div",{className:"min-h-screen bg-terminal-bg flex items-center justify-center",children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("div",{className:"inline-block w-8 h-8 border-2 border-terminal-border border-t-terminal-text rounded-full animate-spin mb-4"}),(0,n.jsx)("p",{className:"text-terminal-text text-sm font-mono",children:"Authenticating..."})]})}):r||l?r&&l?(window.location.href="/",null):(0,n.jsx)(n.Fragment,{children:t}):null}},6281:function(e,t,r){"use strict";r.d(t,{AuthProvider:function(){return a},a:function(){return u}});var n=r(7437),s=r(2265),o=r(6023);let i=(0,s.createContext)(void 0);function a(e){let{children:t}=e,[r,a]=(0,s.useState)(null),[u,c]=(0,s.useState)(!0);(0,s.useEffect)(()=>{let e=o.i.getToken(),t=o.i.getUser();e&&t&&a(t),c(!1)},[]);let l=async(e,t)=>{let r=await o.i.login(e,t);return!!r.success&&!!r.user&&(a(r.user),!0)},f=async(e,t,r)=>{let n=await o.i.signup(e,t,r);return!!n.success&&!!n.user&&(a(n.user),!0)};return(0,n.jsx)(i.Provider,{value:{user:r,isAuthenticated:!!r,isLoading:u,login:l,signup:f,logout:()=>{o.i.logout(),a(null)}},children:t})}function u(){let e=(0,s.useContext)(i);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},6023:function(e,t,r){"use strict";r.d(t,{i:function(){return o}});let n="http://localhost:5001",s=async()=>{try{let e=await fetch("".concat(n,"/api/csrf-token"),{method:"GET",credentials:"include",headers:{"Content-Type":"application/json"}}),t=await e.json();if(e.ok&&t.success&&t.csrfToken)return t.csrfToken;return console.error("Failed to get CSRF token:",t.message),null}catch(e){return console.error("Network error getting CSRF token:",e),null}},o={async login(e,t){try{let r=await s();if(!r)return{success:!1,message:"Security token required. Please refresh and try again."};let o=await fetch("".concat(n,"/api/auth/login"),{method:"POST",credentials:"include",headers:{"Content-Type":"application/json","X-CSRF-Token":r},body:JSON.stringify({email:e,password:t})}),i=await o.json();if(o.ok&&i.token)return localStorage.setItem("token",i.token),localStorage.setItem("user",JSON.stringify(i.user)),{success:!0,user:i.user,token:i.token};return{success:!1,message:i.error||i.message||"Login failed"}}catch(e){return console.error("Login error:",e),{success:!1,message:"Network error occurred"}}},async signup(e,t,r){try{let o=await s();if(!o)return{success:!1,message:"Security token required. Please refresh and try again."};let i=await fetch("".concat(n,"/api/auth/signup"),{method:"POST",credentials:"include",headers:{"Content-Type":"application/json","X-CSRF-Token":o},body:JSON.stringify({email:e,password:t,name:r})}),a=await i.json();if(i.ok&&a.token)return localStorage.setItem("token",a.token),localStorage.setItem("user",JSON.stringify(a.user)),{success:!0,user:a.user,token:a.token};return{success:!1,message:a.error||a.message||"Signup failed"}}catch(e){return console.error("Signup error:",e),{success:!1,message:"Network error occurred"}}},logout(){localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="/login"},getToken:()=>localStorage.getItem("token"),getUser(){let e=localStorage.getItem("user");return e?JSON.parse(e):null},isAuthenticated(){return!!this.getToken()}}},9376:function(e,t,r){"use strict";var n=r(5475);r.o(n,"usePathname")&&r.d(t,{usePathname:function(){return n.usePathname}}),r.o(n,"useRouter")&&r.d(t,{useRouter:function(){return n.useRouter}})},7960:function(){},4742:function(e){e.exports={style:{fontFamily:"'__Inter_f367f3', '__Inter_Fallback_f367f3'",fontStyle:"normal"},className:"__className_f367f3"}}},function(e){e.O(0,[540,971,117,744],function(){return e(e.s=412)}),_N_E=e.O()}]);