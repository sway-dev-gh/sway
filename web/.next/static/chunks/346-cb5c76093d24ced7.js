"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[346],{8346:function(e,t,i){i.d(t,{Z:function(){return k}});var n=i(7437),a=i(429),s=i(2265),r=i(7648),o=i(9376),l=i(5095),c=i(6281),d=i(8378);let m=e=>{let{notification:t,onMarkRead:i,onClose:s}=e,r=d.Z.getNotificationIcon(t.action),o=d.Z.getNotificationColor(t.action),l=d.Z.formatNotificationTime(t.created_at),c=d.Z.getNotificationPriority(t.action);return(0,n.jsx)(a.E.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},onClick:()=>{t.read||i([t.id]),s()},className:"\n        p-3 border-b border-terminal-border cursor-pointer hover:bg-terminal-accent transition-colors\n        ".concat(t.read?"":"bg-terminal-surface","\n        ").concat("high"===c?"border-l-2 border-l-red-500":"","\n        ").concat("medium"===c?"border-l-2 border-l-yellow-500":"","\n      "),children:(0,n.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,n.jsx)("div",{className:"\n          w-8 h-8 rounded-full flex items-center justify-center text-sm\n          ".concat(o,"\n        "),children:r}),(0,n.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsx)("p",{className:"text-sm ".concat(t.read?"text-terminal-muted":"text-terminal-text font-medium"),children:t.description||"".concat(t.actor_name," performed ").concat(t.action)}),!t.read&&(0,n.jsx)("div",{className:"w-2 h-2 bg-blue-500 rounded-full flex-shrink-0"})]}),t.resource_title&&(0,n.jsxs)("p",{className:"text-xs text-terminal-muted mt-1",children:["in ",(0,n.jsx)("span",{className:"text-terminal-text",children:t.resource_title})]}),(0,n.jsxs)("div",{className:"flex items-center justify-between mt-2",children:[(0,n.jsx)("span",{className:"text-xs text-terminal-muted",children:l}),t.local&&(0,n.jsx)("span",{className:"text-xs text-yellow-400 bg-yellow-900/20 px-2 py-1 rounded",children:"Local"})]})]})]})})};var u=()=>{let[e,t]=(0,s.useState)(!1),[i,r]=(0,s.useState)([]),[o,c]=(0,s.useState)(0),[u,x]=(0,s.useState)(!1),h=(0,s.useRef)(null);(0,s.useEffect)(()=>{let e=d.Z.subscribe(e=>{r(e.notifications),c(e.unreadCount)});return d.Z.startPolling(3e4),d.Z.requestNotificationPermission(),()=>{e(),d.Z.stopPolling()}},[]),(0,s.useEffect)(()=>{let e=e=>{h.current&&!h.current.contains(e.target)&&t(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);let f=async()=>{if(!e){x(!0);try{await d.Z.getNotifications()}catch(e){console.error("Error loading notifications:",e)}finally{x(!1)}}t(!e)},p=e=>{d.Z.markAsRead(e)};return(0,n.jsxs)("div",{className:"relative",ref:h,children:[(0,n.jsxs)("button",{onClick:f,className:"relative p-2 text-terminal-muted hover:text-terminal-text transition-colors",children:[(0,n.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 17h5l-5-5h5l-5-5m-6 10v1a3 3 0 01-6 0v-1m6-4V9a3 3 0 116 0v3.5"})}),o>0&&(0,n.jsx)(a.E.span,{initial:{scale:0},animate:{scale:1},className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center",children:o>99?"99+":o})]}),(0,n.jsx)(l.M,{children:e&&(0,n.jsxs)(a.E.div,{initial:{opacity:0,y:-10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.95},className:"absolute right-0 mt-2 w-96 bg-terminal-bg border border-terminal-border rounded-lg shadow-lg z-50",children:[(0,n.jsx)("div",{className:"p-4 border-b border-terminal-border",children:(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)("h3",{className:"text-terminal-text font-medium",children:["Notifications ",o>0&&"(".concat(o,")")]}),(0,n.jsxs)("div",{className:"flex space-x-2",children:[o>0&&(0,n.jsx)("button",{onClick:()=>{d.Z.markAsRead()},className:"text-xs text-terminal-muted hover:text-terminal-text",children:"Mark all read"}),i.length>0&&(0,n.jsx)("button",{onClick:()=>{d.Z.clearAll()},className:"text-xs text-terminal-muted hover:text-red-400",children:"Clear all"})]})]})}),(0,n.jsx)("div",{className:"max-h-96 overflow-y-auto",children:u?(0,n.jsx)("div",{className:"p-4 text-center text-terminal-muted",children:"Loading notifications..."}):i.length>0?(0,n.jsx)(l.M,{children:i.map(e=>(0,n.jsx)(m,{notification:e,onMarkRead:p,onClose:()=>t(!1)},e.id))}):(0,n.jsxs)("div",{className:"p-8 text-center text-terminal-muted",children:[(0,n.jsx)("div",{className:"text-3xl mb-2",children:"\uD83D\uDD14"}),(0,n.jsx)("p",{className:"text-sm",children:"No notifications yet"}),(0,n.jsx)("p",{className:"text-xs mt-1",children:"You'll see activity updates here"})]})}),i.length>0&&(0,n.jsx)("div",{className:"p-3 border-t border-terminal-border",children:(0,n.jsx)("button",{className:"w-full text-center text-xs text-terminal-muted hover:text-terminal-text",children:"View all activity"})})]})})]})},x=i(407),h=i(2451),f=i(7692);let p=[{name:"dashboard",href:"/",icon:"▣"},{name:"workspace",href:"/workspace",icon:"▦"},{name:"teams",href:"/teams",icon:"▩"},{name:"review",href:"/review",icon:"▨",count:3},{name:"settings",href:"/settings",icon:"▥"}];function v(){let[e,t]=(0,s.useState)(!1),i=(0,o.usePathname)(),{user:d,logout:m}=(0,c.a)();return(0,n.jsxs)(a.E.div,{initial:!1,animate:{width:e?64:280},transition:{duration:.3,ease:"easeInOut"},className:"flex flex-col bg-terminal-surface border-r border-terminal-border h-screen font-mono",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-terminal-border",children:[(0,n.jsx)(l.M,{mode:"wait",children:!e&&(0,n.jsx)(a.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},className:"flex items-center space-x-2",children:(0,n.jsx)("img",{src:"/logo.png",alt:"Sway",className:"h-8"})})}),e&&(0,n.jsx)("div",{className:"flex items-center justify-center",children:(0,n.jsx)("img",{src:"/logo.png",alt:"Sway",className:"h-6 w-6"})}),(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,n.jsx)(u,{}),(0,n.jsx)("button",{onClick:()=>t(!e),className:"text-terminal-muted hover:text-terminal-text transition-colors p-1",children:e?(0,n.jsx)(x.Z,{size:16}):(0,n.jsx)(h.Z,{size:16})})]})]}),(0,n.jsx)("nav",{className:"flex-1 p-3",children:(0,n.jsx)("div",{className:"space-y-1",children:p.map((t,s)=>{let o=i===t.href||"/"!==t.href&&i.startsWith(t.href);return(0,n.jsx)(r.default,{href:t.href,children:(0,n.jsxs)(a.E.div,{className:"flex items-center text-sm transition-colors group cursor-pointer relative ".concat(o?"text-terminal-text bg-terminal-hover":"text-terminal-muted hover:text-terminal-text hover:bg-terminal-hover"),children:[(0,n.jsxs)("div",{className:"flex items-center space-x-3 w-full py-3 px-4",children:[!e&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("span",{className:"text-lg",children:t.icon}),(0,n.jsx)("span",{className:"text-terminal-text capitalize",children:t.name}),t.count&&(0,n.jsxs)("span",{className:"text-terminal-muted ml-auto text-xs",children:["(",t.count,")"]})]}),e&&(0,n.jsx)("div",{className:"flex items-center justify-center w-full",children:(0,n.jsx)("span",{className:"text-lg",children:t.icon})})]}),o&&(0,n.jsx)(a.E.div,{layoutId:"activeTab",className:"absolute left-0 top-0 bottom-0 w-1 bg-terminal-text"})]})},t.name)})})}),(0,n.jsxs)("div",{className:"border-t border-terminal-border p-4",children:[(0,n.jsx)(l.M,{mode:"wait",children:!e&&(0,n.jsxs)(a.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},className:"space-y-3",children:[(0,n.jsxs)("div",{className:"text-xs text-terminal-muted space-y-1",children:[(0,n.jsx)("div",{className:"text-terminal-text font-medium",children:(null==d?void 0:d.username)||(null==d?void 0:d.email)||"User"}),(0,n.jsx)("div",{className:"text-[10px]",children:null==d?void 0:d.email})]}),(0,n.jsxs)("button",{onClick:m,className:"flex items-center space-x-2 w-full text-xs text-terminal-muted hover:text-terminal-text transition-colors py-2 px-2 hover:bg-terminal-hover rounded-sm",children:[(0,n.jsx)(f.Z,{size:12}),(0,n.jsx)("span",{children:"Logout"})]})]})}),e&&(0,n.jsxs)("div",{className:"flex flex-col items-center space-y-2",children:[(0,n.jsx)("div",{className:"w-2 h-2 bg-terminal-text rounded-full"}),(0,n.jsx)("button",{onClick:m,className:"text-terminal-muted hover:text-terminal-text transition-colors p-1",children:(0,n.jsx)(f.Z,{size:12})})]})]})]})}var g=i(1723),j=i(4401),b=i(8736);function N(){let[e,t]=(0,s.useState)(!1),[i,r]=(0,s.useState)("logs"),o=[{key:"logs",label:"Recent",icon:g.Z},{key:"activity",label:"Activity",icon:j.Z},{key:"output",label:"Notifications",icon:b.Z}];return(0,n.jsxs)(a.E.div,{initial:!1,animate:{width:e?64:320},transition:{duration:.3,ease:"easeInOut"},className:"flex flex-col bg-terminal-surface border-l border-terminal-border h-screen",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-terminal-border",children:[(0,n.jsx)(l.M,{mode:"wait",children:!e&&(0,n.jsx)(a.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},className:"flex items-center space-x-2",children:(0,n.jsx)("span",{className:"text-sm text-terminal-text font-medium",children:"Activity"})})}),(0,n.jsx)("button",{onClick:()=>t(!e),className:"text-terminal-muted hover:text-terminal-text transition-colors p-1",children:e?(0,n.jsx)(h.Z,{size:16}):(0,n.jsx)(x.Z,{size:16})})]}),(0,n.jsx)(l.M,{mode:"wait",children:!e&&(0,n.jsx)(a.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},className:"flex border-b border-terminal-border",children:o.map(e=>(0,n.jsx)("button",{onClick:()=>r(e.key),className:"flex-1 px-2 py-2 text-xs font-mono uppercase tracking-wider transition-colors ".concat(i===e.key?"bg-terminal-accent text-terminal-text border-b border-terminal-text":"text-terminal-muted hover:text-terminal-text hover:bg-terminal-hover"),children:(0,n.jsxs)("div",{className:"flex items-center justify-center space-x-1",children:[(0,n.jsx)(e.icon,{size:12}),(0,n.jsx)("span",{className:"hidden sm:inline",children:e.label})]})},e.key))})}),(0,n.jsxs)("div",{className:"flex-1 overflow-hidden",children:[(0,n.jsx)(l.M,{mode:"wait",children:!e&&(0,n.jsxs)(a.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},className:"h-full p-2",children:["logs"===i&&(0,n.jsxs)("div",{className:"space-y-3",children:[(0,n.jsx)("div",{className:"text-sm text-terminal-text mb-3 border-b border-terminal-border pb-2",children:"Recent Activity"}),(0,n.jsx)("div",{className:"space-y-3 max-h-full overflow-y-auto",children:(0,n.jsx)("div",{className:"text-center py-8",children:(0,n.jsx)("p",{className:"text-terminal-muted text-sm",children:"No recent activity"})})})]}),"activity"===i&&(0,n.jsxs)("div",{className:"space-y-3",children:[(0,n.jsx)("div",{className:"text-sm text-terminal-text mb-3 border-b border-terminal-border pb-2",children:"Activity Feed"}),(0,n.jsx)("div",{className:"space-y-3",children:(0,n.jsx)("div",{className:"text-center py-8",children:(0,n.jsx)("p",{className:"text-terminal-muted text-sm",children:"No activity yet"})})})]}),"output"===i&&(0,n.jsxs)("div",{className:"space-y-3",children:[(0,n.jsx)("div",{className:"text-sm text-terminal-text mb-3 border-b border-terminal-border pb-2",children:"Notifications"}),(0,n.jsx)("div",{className:"space-y-3",children:(0,n.jsx)("div",{className:"text-center py-8",children:(0,n.jsx)("p",{className:"text-terminal-muted text-sm",children:"No notifications"})})})]})]})}),e&&(0,n.jsx)("div",{className:"flex flex-col items-center py-4 space-y-3",children:o.map(e=>(0,n.jsx)("button",{onClick:()=>r(e.key),className:"p-2 rounded transition-colors relative ".concat(i===e.key?"bg-terminal-accent text-terminal-text":"text-terminal-muted hover:text-terminal-text hover:bg-terminal-hover"),title:e.label,children:(0,n.jsx)(e.icon,{size:16})},e.key))})]}),(0,n.jsx)("div",{className:"border-t border-terminal-border p-2",children:(0,n.jsx)(l.M,{mode:"wait",children:!e&&(0,n.jsx)(a.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},className:"text-xs font-mono text-terminal-muted text-center",children:"SYSTEM ONLINE"})})})]})}let y=e=>{let{notification:t,onDismiss:i}=e,r=d.Z.getNotificationIcon(t.action),o=d.Z.getNotificationColor(t.action),l=d.Z.getNotificationPriority(t.action);return(0,s.useEffect)(()=>{let e=setTimeout(()=>{i(t.id)},"high"===l?8e3:"medium"===l?5e3:3e3);return()=>clearTimeout(e)},[t.id,l,i]),(0,n.jsxs)(a.E.div,{layout:!0,initial:{opacity:0,y:-50,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-50,scale:.95,transition:{duration:.2}},className:"\n        relative bg-terminal-surface border border-terminal-border rounded-lg p-4 mb-3 min-w-80 max-w-96 shadow-lg\n        ".concat("high"===l?"border-l-4 border-l-red-500":"","\n        ").concat("medium"===l?"border-l-4 border-l-yellow-500":"","\n      "),children:[(0,n.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,n.jsx)("div",{className:"\n          w-8 h-8 rounded-full flex items-center justify-center text-sm flex-shrink-0\n          ".concat(o,"\n        "),children:r}),(0,n.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,n.jsxs)("div",{className:"flex items-start justify-between",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"text-sm text-terminal-text font-medium",children:t.description}),t.resource_title&&(0,n.jsxs)("p",{className:"text-xs text-terminal-muted mt-1",children:["in ",(0,n.jsx)("span",{className:"text-terminal-text",children:t.resource_title})]})]}),(0,n.jsx)("button",{onClick:()=>i(t.id),className:"text-terminal-muted hover:text-terminal-text ml-3 flex-shrink-0",children:(0,n.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,n.jsxs)("div",{className:"flex items-center justify-between mt-2",children:[(0,n.jsx)("span",{className:"text-xs text-terminal-muted",children:d.Z.formatNotificationTime(t.created_at)}),t.local&&(0,n.jsx)("span",{className:"text-xs text-yellow-400",children:"Local"})]})]})]}),(0,n.jsx)(a.E.div,{className:"absolute bottom-0 left-0 h-1 bg-terminal-text rounded-b",initial:{width:"100%"},animate:{width:"0%"},transition:{duration:"high"===l?8:"medium"===l?5:3,ease:"linear"}})]})};var w=()=>{let[e,t]=(0,s.useState)([]);(0,s.useEffect)(()=>{let i=d.Z.subscribe(i=>{let n=i.notifications.filter(t=>!t.read&&!e.find(e=>e.id===t.id)&&"low"!==d.Z.getNotificationPriority(t.action)&&!t.local);n.length>0&&(t(e=>[...n.slice(0,3),...e].slice(0,5)),n.forEach(e=>{"high"===d.Z.getNotificationPriority(e.action)&&d.Z.showBrowserNotification("SwayFiles Notification",e.description,null,null)}))});return()=>{i()}},[e]);let i=e=>{t(t=>t.filter(t=>t.id!==e)),d.Z.markAsRead([e])};return(0,n.jsx)("div",{className:"fixed top-4 right-4 z-50 pointer-events-none",children:(0,n.jsx)("div",{className:"pointer-events-auto",children:(0,n.jsx)(l.M,{mode:"popLayout",children:e.map(e=>(0,n.jsx)(y,{notification:e,onDismiss:i},e.id))})})})};function k(e){let{children:t}=e;return(0,n.jsxs)("div",{className:"flex h-screen bg-terminal-bg overflow-hidden font-mono",children:[(0,n.jsx)(v,{}),(0,n.jsx)(a.E.main,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.2},className:"flex-1 flex flex-col overflow-hidden bg-terminal-bg",children:t}),(0,n.jsx)(N,{}),(0,n.jsx)(w,{})]})}},6281:function(e,t,i){i.d(t,{AuthProvider:function(){return o},a:function(){return l}});var n=i(7437),a=i(2265),s=i(6023);let r=(0,a.createContext)(void 0);function o(e){let{children:t}=e,[i,o]=(0,a.useState)(null),[l,c]=(0,a.useState)(!0);(0,a.useEffect)(()=>{let e=s.i.getToken(),t=s.i.getUser();e&&t&&o(t),c(!1)},[]);let d=async(e,t)=>{let i=await s.i.login(e,t);return!!i.success&&!!i.user&&(o(i.user),!0)},m=async(e,t,i)=>{let n=await s.i.signup(e,t,i);return!!n.success&&!!n.user&&(o(n.user),!0)};return(0,n.jsx)(r.Provider,{value:{user:i,isAuthenticated:!!i,isLoading:l,login:d,signup:m,logout:()=>{s.i.logout(),o(null)}},children:t})}function l(){let e=(0,a.useContext)(r);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},6023:function(e,t,i){i.d(t,{i:function(){return s}});let n="https://api.swayfiles.com",a=async()=>{try{let e=await fetch("".concat(n,"/api/csrf-token"),{method:"GET",credentials:"include",headers:{"Content-Type":"application/json"}}),t=await e.json();if(e.ok&&t.success&&t.csrfToken)return t.csrfToken;return console.error("Failed to get CSRF token:",t.message),null}catch(e){return console.error("Network error getting CSRF token:",e),null}},s={async login(e,t){try{let i=await a(),s={"Content-Type":"application/json"};i&&(s["X-CSRF-Token"]=i);let r=await fetch("".concat(n,"/api/auth/login"),{method:"POST",credentials:"include",headers:s,body:JSON.stringify({email:e,password:t})}),o=await r.json();if(r.ok&&o.token)return localStorage.setItem("token",o.token),localStorage.setItem("user",JSON.stringify(o.user)),{success:!0,user:o.user,token:o.token};return{success:!1,message:o.error||o.message||"Login failed"}}catch(e){return console.error("Login error:",e),{success:!1,message:"Network error occurred"}}},async signup(e,t,i){try{let s=await a(),r={"Content-Type":"application/json"};s&&(r["X-CSRF-Token"]=s);let o=await fetch("".concat(n,"/api/auth/signup"),{method:"POST",credentials:"include",headers:r,body:JSON.stringify({email:e,password:t,name:i})}),l=await o.json();if(o.ok&&l.token)return localStorage.setItem("token",l.token),localStorage.setItem("user",JSON.stringify(l.user)),{success:!0,user:l.user,token:l.token};return{success:!1,message:l.error||l.message||"Signup failed"}}catch(e){return console.error("Signup error:",e),{success:!1,message:"Network error occurred"}}},logout(){localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="/login"},getToken:()=>localStorage.getItem("token"),getUser(){let e=localStorage.getItem("user");return e?JSON.parse(e):null},isAuthenticated(){return!!this.getToken()}}},8378:function(e,t){class i{async makeRequest(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=localStorage.getItem("token"),n={headers:{"Content-Type":"application/json",...i&&{Authorization:"Bearer ".concat(i)}}},a=await fetch("".concat("https://api.swayfiles.com").concat(e),{...n,...t,headers:{...n.headers,...t.headers}});if(!a.ok)throw Error(await a.text()||"HTTP error! status: ".concat(a.status));return a.json()}async getNotifications(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;try{let t=await this.makeRequest("/activity/notifications".concat(e?"?since=".concat(e):""));if(t.success)return this.notifications=t.notifications||[],this.unreadCount=t.unread_count||0,this.notifyListeners(),t;return{notifications:[],unread_count:0}}catch(e){return console.error("Error fetching notifications:",e),{notifications:[],unread_count:0}}}async getActivityFeed(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{let{type:t="all",limit:i=20,offset:n=0,since:a,before:s}=e,r=new URLSearchParams({type:t,limit:i.toString(),offset:n.toString()});return a&&r.append("since",a),s&&r.append("before",s),await this.makeRequest("/activity?".concat(r.toString()))}catch(e){throw console.error("Error fetching activity feed:",e),e}}markAsRead(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];0===e.length?(this.notifications=this.notifications.map(e=>({...e,read:!0})),this.unreadCount=0):(this.notifications=this.notifications.map(t=>e.includes(t.id)?{...t,read:!0}:t),this.unreadCount=Math.max(0,this.unreadCount-e.length)),this.notifyListeners()}clearAll(){this.notifications=[],this.unreadCount=0,this.notifyListeners()}startPolling(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3e4;this.isPolling||(this.isPolling=!0,this.pollInterval=setInterval(()=>{this.getNotifications()},e),this.getNotifications())}stopPolling(){this.pollInterval&&(clearInterval(this.pollInterval),this.pollInterval=null),this.isPolling=!1}subscribe(e){return this.listeners.add(e),()=>this.listeners.delete(e)}notifyListeners(){this.listeners.forEach(e=>{e({notifications:this.notifications,unreadCount:this.unreadCount})})}getNotificationIcon(e){let t={project_created:"\uD83C\uDD95",project_shared:"\uD83D\uDCE4",project_updated:"\uD83D\uDCDD",project_completed:"✅",collaboration_created:"\uD83E\uDD1D",collaboration_invited:"\uD83D\uDC8C",collaboration_accepted:"✓",collaboration_ended:"\uD83D\uDC4B",review_assigned:"\uD83D\uDC41️",review_approved:"✅",review_rejected:"❌",review_changes_requested:"\uD83D\uDD04",team_invitation_sent:"\uD83D\uDCE8",team_invitation_accepted:"\uD83C\uDF89",team_member_removed:"➖",review_comment_added:"\uD83D\uDCAC",comment_reply:"↩️",file_uploaded:"\uD83D\uDCC1",file_request_created:"\uD83D\uDCCB",edit_request_created:"✏️",edit_request_approved:"✅",edit_started:"⚡",default:"\uD83D\uDCE2"};return t[e]||t.default}getNotificationColor(e){let t={project_completed:"text-green-400 bg-green-900/20",review_approved:"text-green-400 bg-green-900/20",collaboration_accepted:"text-green-400 bg-green-900/20",team_invitation_accepted:"text-green-400 bg-green-900/20",review_changes_requested:"text-yellow-400 bg-yellow-900/20",review_rejected:"text-yellow-400 bg-yellow-900/20",collaboration_ended:"text-red-400 bg-red-900/20",team_member_removed:"text-red-400 bg-red-900/20",default:"text-blue-400 bg-blue-900/20"};return t[e]||t.default}formatNotificationTime(e){if(!e)return"Unknown";let t=new Date,i=new Date(e),n=t-i,a=Math.floor(n/6e4),s=Math.floor(n/36e5),r=Math.floor(n/864e5);return a<1?"Just now":a<60?"".concat(a,"m ago"):s<24?"".concat(s,"h ago"):r<7?"".concat(r,"d ago"):i.toLocaleDateString()}getNotificationPriority(e){return["review_assigned","collaboration_invited","team_invitation_sent","edit_request_created","review_changes_requested"].includes(e)?"high":["review_approved","collaboration_accepted","team_invitation_accepted","comment_reply","review_comment_added"].includes(e)?"medium":"low"}createLocalNotification(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a={id:"local_".concat(Date.now()),action:e,description:i,actor_name:"You",created_at:new Date().toISOString(),resource_title:t,metadata:n,read:!1,local:!0};this.notifications.unshift(a),this.unreadCount+=1,this.notifyListeners(),setTimeout(()=>{this.notifications=this.notifications.filter(e=>e.id!==a.id),this.unreadCount=Math.max(0,this.unreadCount-1),this.notifyListeners()},5e3)}async requestNotificationPermission(){return"Notification"in window?"granted"===Notification.permission?"granted":"denied"!==Notification.permission?await Notification.requestPermission():Notification.permission:"not-supported"}showBrowserNotification(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if("granted"===Notification.permission){let a=new Notification(e,{body:t,icon:i||"/favicon.ico",tag:"swayfiles-notification"});return n&&(a.onclick=n),setTimeout(()=>a.close(),5e3),a}}constructor(){this.listeners=new Set,this.notifications=[],this.unreadCount=0,this.pollInterval=null,this.isPolling=!1}}let n=new i;t.Z=n}}]);